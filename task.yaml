apiVersion: tekton.dev/v1alpha1
kind: PipelineResource
metadata:
  name: kbit-git
spec:
  type: git
  params:
    - name: url
      value: https://github.com/Dimss/kbit-api
---
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: springboot-mvn
spec:
  inputs:
    resources:
    - name: workspace
      type: git
  steps:
  - name: mvn-unittests
    image: "docker.io/dimssss/java11-mvn:latest"
    command:
    - /bin/bash
    args:
    - -c
    - |
      cd workspace
      mvn test
  - name: mvn-package
    image: "docker.io/dimssss/java11-mvn:latest"
    command:
    - /bin/bash
    args:
    - -c
    - |
      cd workspace
      mvn package
      ls -all
---
apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: t
spec:
  taskRef:
    name: springboot-mvn
  inputs:
    resources:
    - name: workspace
      resourceRef:
        name: kbit-git
